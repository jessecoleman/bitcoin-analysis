import pandas as pd
import numpy as np

d = {640: [('2013-12-27', 0.0034113154885352659)], 70: [('2013-12-27', 0.0036322756963153911)], 1095: [('2013-12-27', 0.005277847770046324)], 11: [('2013-12-27', 0.019913554164324616)], 16013: [('2013-12-27', 0.0068342604616905391), ('2014-01-07', 0.0087073409755676293), ('2014-01-11', 0.0099837085926730434)], 238: [('2013-12-27', 0.0069195433489039207), ('2014-01-07', 0.0055570783285209535)], 240861: [('2013-12-27', 0.0052662182854263167)], 51: [('2013-12-27', 0.01399608474017793), ('2014-01-07', 0.0065671148625561808), ('2014-01-11', 0.014686450869644558), ('2014-01-20', 0.02324762314070378), ('2014-01-28', 0.026292814684140613), ('2014-02-08', 0.027520113676506197), ('2014-02-17', 0.021375692711197599)], 97: [('2013-12-27', 0.0033124648692652099)], 106: [('2013-12-27', 0.010931715542806194), ('2014-01-07', 0.008831248803163029), ('2014-01-11', 0.010847746795033869), ('2014-01-20', 0.010933028648099037), ('2014-01-28', 0.012252071632031633), ('2014-02-08', 0.010492452657942472), ('2014-02-17', 0.0099411988662802993)], 363: [('2013-12-27', 0.00318260229100847)], 300: [('2013-12-27', 0.0055569554009264818)], 302: [('2013-12-27', 0.0029945922896516966)], 243: [('2013-12-27', 0.012542399162677105), ('2014-01-07', 0.008636000105133915), ('2014-01-11', 0.0095044202259690746), ('2014-01-20', 0.0078218849254185051), ('2014-01-28', 0.0056837818934692202)], 564: [('2013-12-27', 0.0032174907448684897)], 245: [('2013-12-27', 0.01383133370806117), ('2014-01-07', 0.011200516658093247), ('2014-01-11', 0.011720579279352565), ('2014-01-20', 0.010509544125200474), ('2014-01-28', 0.011572310973302606), ('2014-02-08', 0.010514282992581656), ('2014-02-17', 0.010569398028681416)], 951: [('2013-12-27', 0.0045258077646192305)], 1332: [('2013-12-27', 0.0029597038357916769)], 124: [('2013-12-27', 0.04824297869866067), ('2014-01-07', 0.036380089138540218), ('2014-01-11', 0.03021715280724473), ('2014-01-20', 0.035237266638015075), ('2014-01-28', 0.033116628911285501), ('2014-02-08', 0.03286259193547747), ('2014-02-17', 0.027685181268243157)], 317: [('2013-12-27', 0.015199736398348611), ('2014-01-07', 0.012341970585032686), ('2014-01-11', 0.015266873478864042), ('2014-01-20', 0.014023207790438055), ('2014-01-28', 0.013750821036217321), ('2014-02-08', 0.013016833172582688), ('2014-02-17', 0.010685731206903845)]}
{640: [('2013-12-27', 0.0034113154885352659)], 70: [('2013-12-27', 0.0036322756963153911)], 1095: [('2013-12-27', 0.005277847770046324)], 11: [('2013-12-27', 0.019913554164324616)], 16013: [('2013-12-27', 0.0068342604616905391), ('2014-01-07', 0.0087073409755676293), ('2014-01-11', 0.0099837085926730434)], 238: [('2013-12-27', 0.0069195433489039207), ('2014-01-07', 0.0055570783285209535)], 240861: [('2013-12-27', 0.0052662182854263167)], 51: [('2013-12-27', 0.01399608474017793), ('2014-01-07', 0.0065671148625561808), ('2014-01-11', 0.014686450869644558), ('2014-01-20', 0.02324762314070378), ('2014-01-28', 0.026292814684140613), ('2014-02-08', 0.027520113676506197), ('2014-02-17', 0.021375692711197599)], 97: [('2013-12-27', 0.0033124648692652099)], 106: [('2013-12-27', 0.010931715542806194), ('2014-01-07', 0.008831248803163029), ('2014-01-11', 0.010847746795033869), ('2014-01-20', 0.010933028648099037), ('2014-01-28', 0.012252071632031633), ('2014-02-08', 0.010492452657942472), ('2014-02-17', 0.0099411988662802993)], 363: [('2013-12-27', 0.00318260229100847)], 300: [('2013-12-27', 0.0055569554009264818)], 302: [('2013-12-27', 0.0029945922896516966)], 243: [('2013-12-27', 0.012542399162677105), ('2014-01-07', 0.008636000105133915), ('2014-01-11', 0.0095044202259690746), ('2014-01-20', 0.0078218849254185051), ('2014-01-28', 0.0056837818934692202)], 564: [('2013-12-27', 0.0032174907448684897)], 245: [('2013-12-27', 0.01383133370806117), ('2014-01-07', 0.011200516658093247), ('2014-01-11', 0.011720579279352565), ('2014-01-20', 0.010509544125200474), ('2014-01-28', 0.011572310973302606), ('2014-02-08', 0.010514282992581656), ('2014-02-17', 0.010569398028681416)], 951: [('2013-12-27', 0.0045258077646192305)], 1332: [('2013-12-27', 0.0029597038357916769)], 124: [('2013-12-27', 0.04824297869866067), ('2014-01-07', 0.036380089138540218), ('2014-01-11', 0.03021715280724473), ('2014-01-20', 0.035237266638015075), ('2014-01-28', 0.033116628911285501), ('2014-02-08', 0.03286259193547747), ('2014-02-17', 0.027685181268243157)], 317: [('2013-12-27', 0.015199736398348611), ('2014-01-07', 0.012341970585032686), ('2014-01-11', 0.015266873478864042), ('2014-01-20', 0.014023207790438055), ('2014-01-28', 0.013750821036217321), ('2014-02-08', 0.013016833172582688), ('2014-02-17', 0.010685731206903845)]}

def split_date(date):
    date = date.split('-')
    date = str(date[0]) + '' + (date[2]) + '' + (date[1])
    return date

prev_df = pd.DataFrame()
flag = False
index = 0
for key in d.keys():
    df = pd.DataFrame(d[key], columns=['date', 'score' + str(index)])
    index = index + 1
    df = df.set_index('date')
    #print(df.columns)
    if flag:
        prev_df = pd.concat([prev_df, df], axis=1)  
        #print(df)
    df = prev_df
    flag = True

prev_df = prev_df.reset_index()
#print(prev_df)
prev_df['date'] = prev_df['date'].apply(split_date)
prev_df = prev_df.set_index('date')
prev_df = prev_df.apply(lambda x: np.log10(x), axis=0)
print(prev_df)

prev_df.to_csv('user_trajectories.tsv', sep='\t')

